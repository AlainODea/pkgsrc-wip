CC=@CC@
CFLAGS=@CFLAGS@ -Wunused
HOSTOS=@HOSTOS@
HOSTVER=@HOSTREL@
HOSTARCH=@HOSTARCH@
CONFIG_DIR=@CONFIG_DIR@

.PHONY: all clean install partclean distclean indent ChangeLog distrib

all:
	cd src; make
	cd man5; make
	cd man8; make

clean:
	-cd src; make clean
	-cd man5; make clean
	-cd man8; make clean

install:
	cd src; make install
	cd man5; make install
	cd man8; make install
	-[ -d "$(CONFIG_DIR)" ] || install -d $(CONFIG_DIR)
	[ -f "$(CONFIG_DIR)/ldapuseradd.conf" ] || install -m 600 -b conf/* $(CONFIG_DIR)

partclean: clean
	-/bin/rm -rf config.status config.cache config.log autom4te.cache ChangeLog.bak

distclean: partclean
	-/bin/rm -rf Makefile src/Makefile src/hooks/Makefile man5/Makefile man8/Makefile config.h
	-find . -name .svn | xargs -l rm -rf

indent:
	indent -kr -br -nce -nut src/*.c src/*.h src/*/*.c src/*/*.h

# This is a .PHONY target because it exists but has no local dependencies
ChangeLog:
	svn2cl

distrib: ChangeLog distclean

